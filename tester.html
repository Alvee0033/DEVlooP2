<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>HackTheAI API Console (Q1–Q20)</title>
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --card: #0b1220;
      --muted: #94a3b8;
      --fg: #e5e7eb;
      --accent: #60a5fa;
      --accent-2: #34d399;
      --border: #1f2937;
      --danger: #f87171;
    }
    html, body { height: 100%; }
    body {
      margin: 0; padding: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: linear-gradient(180deg, var(--bg), #0b1020 60%);
      color: var(--fg);
    }
    .container { max-width: 1200px; margin: 0 auto; padding: 24px; }
    .header {
      display: flex; align-items: center; justify-content: space-between;
      margin-bottom: 16px; padding: 16px 0; border-bottom: 1px solid var(--border);
    }
    .title { font-size: 22px; font-weight: 700; letter-spacing: .2px; }
    .subtitle { color: var(--muted); font-size: 13px; }
    .layout { display: grid; grid-template-columns: 1.35fr .65fr; gap: 16px; align-items: start; }
    .panel {
      background: var(--panel); border: 1px solid var(--border); border-radius: 12px;
      padding: 16px; box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 12px; }
    .card {
      background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 12px;
      display: flex; flex-direction: column; gap: 8px;
    }
    .card h2 { margin: 0 0 8px; font-size: 15px; color: var(--accent); letter-spacing: .2px; }
    .row { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; margin: 6px 0; }
    label { font-size: 12px; color: var(--muted); display: flex; align-items: center; gap: 6px; }
    input { background: #0a0f1a; color: var(--fg); border: 1px solid var(--border); border-radius: 8px; padding: 8px 10px; font-size: 13px; max-width: 160px; }
    button {
      background: linear-gradient(180deg, #1e293b, #0f172a); color: #e2e8f0; border: 1px solid #1f2937; border-radius: 10px;
      padding: 8px 12px; font-size: 13px; cursor: pointer; transition: transform .08s ease, border-color .2s ease, background .2s ease;
    }
    button:hover { transform: translateY(-1px); border-color: #334155; }
    button.primary { background: linear-gradient(180deg, #3b82f6, #2563eb); border-color: #1d4ed8; }
    button.success { background: linear-gradient(180deg, #10b981, #059669); border-color: #047857; }
    button.warn { background: linear-gradient(180deg, #f59e0b, #d97706); border-color: #b45309; }
    button.danger { background: linear-gradient(180deg, #ef4444, #dc2626); border-color: #b91c1c; }
    .row button { flex: 0 0 auto; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%; }
    .row.actions { justify-content: flex-start; }
    .endpoint { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size: 12px; color: var(--muted); }
    .out {
      height: 70vh; overflow: auto; background: #0a0f1a; border: 1px solid var(--border); border-radius: 12px; padding: 12px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size: 12px; line-height: 1.45; white-space: pre-wrap;
    }
    .help { font-size: 12px; color: var(--muted); margin-top: 6px; }
  </style>
  <script>
    async function run(path, opts) {
      const out = document.getElementById('out');
      try {
        const resp = await fetch(`http://localhost:3000${path}`, {
          headers: { 'Content-Type': 'application/json' },
          ...opts
        });
        const text = await resp.text();
        out.textContent = `${resp.status} ${resp.statusText}\n${text}`;
      } catch (e) {
        out.textContent = String(e);
      }
    }

    function createVoter(){
      const voter_id = Number(document.getElementById('voter_id').value);
      const name = document.getElementById('name').value;
      const age = Number(document.getElementById('age').value);
      run('/api/voters', { method:'POST', body: JSON.stringify({ voter_id, name, age }) });
    }
    function getVoter(){
      const id = document.getElementById('get_voter_id').value;
      run(`/api/voters/${encodeURIComponent(id)}`);
    }

    // Q3 — List Voters
    function listVoters(){ run('/api/voters'); }

    // Q4 — Update Voter
    function updateVoter(){
      const id = Number(document.getElementById('upd_voter_id').value);
      const name = document.getElementById('upd_name').value;
      const age = Number(document.getElementById('upd_age').value);
      run(`/api/voters/${encodeURIComponent(id)}`, { method:'PUT', body: JSON.stringify({ name, age }) });
    }

    // Q5 — Delete Voter
    function deleteVoter(){
      const id = Number(document.getElementById('del_voter_id').value);
      run(`/api/voters/${encodeURIComponent(id)}`, { method:'DELETE' });
    }

    // Q6 — Register Candidate
    function registerCandidate(){
      const candidate_id = Number(document.getElementById('cand_id').value);
      const name = document.getElementById('cand_name').value;
      const party = document.getElementById('cand_party').value;
      run('/api/candidates', { method:'POST', body: JSON.stringify({ candidate_id, name, party }) });
    }

    // Q7 — List Candidates
    function listCandidates(){ run('/api/candidates'); }

    // Q8 — Cast Vote
    function castVote(){
      const voter_id = Number(document.getElementById('vote_voter_id').value);
      const candidate_id = Number(document.getElementById('vote_cand_id').value);
      run('/api/votes', { method:'POST', body: JSON.stringify({ voter_id, candidate_id }) });
    }

    // Q8 — Cast Vote with auto-setup (creates voter/candidate if missing)
    async function castVoteAuto(){
      const voter_id = Number(document.getElementById('vote_voter_id').value) || 1;
      const candidate_id = Number(document.getElementById('vote_cand_id').value) || 2;
      const out = document.getElementById('out');
      const api = (path, opts={}) => fetch(`http://localhost:3000${path}`, { headers:{'Content-Type':'application/json'}, ...opts });
      try {
        // Try to create voter (ignore if already exists)
        await api('/api/voters', { method:'POST', body: JSON.stringify({ voter_id, name: `Voter ${voter_id}`, age: 22 }) });
      } catch(_) {}
      try {
        // Register/overwrite candidate (server replaces in our impl)
        await api('/api/candidates', { method:'POST', body: JSON.stringify({ candidate_id, name: `Candidate ${candidate_id}`, party: 'Party' }) });
      } catch(_) {}
      const resp = await api('/api/votes', { method:'POST', body: JSON.stringify({ voter_id, candidate_id }) });
      const text = await resp.text();
      out.textContent = `${resp.status} ${resp.statusText}\n${text}`;
    }

    // Q9 — Candidate Votes
    function candidateVotes(){
      const id = Number(document.getElementById('cand_votes_id').value);
      run(`/api/candidates/${encodeURIComponent(id)}/votes`);
    }

    // Q10 — Filter Candidates
    function filterCandidates(){
      const party = document.getElementById('filter_party').value;
      run(`/api/candidates?party=${encodeURIComponent(party)}`);
    }

    // Q11 — Results
    function results(){ run('/api/results'); }

    // Q12 — Winner
    function winner(){ run('/api/results/winner'); }

    // Q13 — Timeline
    function timeline(){
      const id = Number(document.getElementById('timeline_cand_id').value);
      run(`/api/votes/timeline?candidate_id=${encodeURIComponent(id)}`);
    }


    // Q14 — Weighted Vote
    function weighted(){
      const voter_id = Number(document.getElementById('w_voter_id').value);
      const candidate_id = Number(document.getElementById('w_cand_id').value);
      run('/api/votes/weighted', { method:'POST', body: JSON.stringify({ voter_id, candidate_id }) });
    }

    // Q15 — Range Votes
    function rangeVotes(){
      const id = Number(document.getElementById('range_cand_id').value);
      const from = document.getElementById('range_from').value;
      const to = document.getElementById('range_to').value;
      run(`/api/votes/range?candidate_id=${encodeURIComponent(id)}&from=${encodeURIComponent(from)}&to=${encodeURIComponent(to)}`);
    }

    // Q16 — Encrypted Ballot
    function encryptedBallot(){
      const payload = {
        election_id: document.getElementById('enc_election').value,
        ciphertext: document.getElementById('enc_ciphertext').value,
        zk_proof: document.getElementById('enc_proof').value,
        voter_pubkey: document.getElementById('enc_pubkey').value,
        nullifier: document.getElementById('enc_nullifier').value,
        signature: document.getElementById('enc_sig').value,
      };
      run('/api/ballots/encrypted', { method:'POST', body: JSON.stringify(payload) });
    }

    // Q17 — Homomorphic
    function homomorphic(){
      const body = { cipher_aggregate: 'abc', tally_key: 'key' };
      run('/api/results/homomorphic', { method:'POST', body: JSON.stringify(body) });
    }

    // Q18 — DP Analytics
    function dp(){ run('/api/analytics/dp', { method:'POST', body: JSON.stringify({}) }); }

    // Q19 — Ranked
    function ranked(){ run('/api/ballots/ranked', { method:'POST', body: JSON.stringify({}) }); }

    // Q20 — RLA
    function rla(){ run('/api/audits/rla', { method:'POST', body: JSON.stringify({}) }); }
  </script>
  </head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <div class="title">HackTheAI API Console</div>
        <div class="subtitle">Interact with all 20 endpoints. Exact status codes and JSON shown on the right.</div>
      </div>
      <div class="subtitle endpoint">Base URL: http://localhost:3000</div>
    </div>

    <div class="layout">
      <div class="panel">
        <div class="grid">
          <div class="card">
            <h2>Q1 — Create Voter</h2>
            <div class="row">
              <label>voter_id <input id="voter_id" type="number" value="1" /></label>
              <label>name <input id="name" type="text" value="Alice" /></label>
              <label>age <input id="age" type="number" value="22" /></label>
            </div>
            <div class="row"><button class="primary" onclick="createVoter()">POST /api/voters</button></div>
          </div>

          <div class="card">
            <h2>Q2 — Get Voter</h2>
            <div class="row"><label>voter_id <input id="get_voter_id" type="number" value="1" /></label></div>
            <div class="row"><button onclick="getVoter()">GET /api/voters/{id}</button></div>
          </div>

          <div class="card">
            <h2>Q3 — List Voters</h2>
            <div class="row"><button onclick="listVoters()">GET /api/voters</button></div>
          </div>

          <div class="card">
            <h2>Q4 — Update Voter</h2>
            <div class="row">
              <label>voter_id <input id="upd_voter_id" type="number" value="1" /></label>
              <label>name <input id="upd_name" type="text" value="Alice Smith" /></label>
              <label>age <input id="upd_age" type="number" value="25" /></label>
            </div>
            <div class="row"><button class="success" onclick="updateVoter()">PUT /api/voters/{id}</button></div>
          </div>

          <div class="card">
            <h2>Q5 — Delete Voter</h2>
            <div class="row"><label>voter_id <input id="del_voter_id" type="number" value="1" /></label></div>
            <div class="row"><button class="danger" onclick="deleteVoter()">DELETE /api/voters/{id}</button></div>
          </div>

          <div class="card">
            <h2>Q6 — Register Candidate</h2>
            <div class="row">
              <label>candidate_id <input id="cand_id" type="number" value="2" /></label>
              <label>name <input id="cand_name" type="text" value="Jane Roe" /></label>
              <label>party <input id="cand_party" type="text" value="Red Party" /></label>
            </div>
            <div class="row"><button class="primary" onclick="registerCandidate()">POST /api/candidates</button></div>
          </div>

          <div class="card">
            <h2>Q7 — List Candidates</h2>
            <div class="row"><button onclick="listCandidates()">GET /api/candidates</button></div>
          </div>

          <div class="card">
            <h2>Q8 — Cast Vote</h2>
            <div class="row">
              <label>voter_id <input id="vote_voter_id" type="number" value="1" /></label>
              <label>candidate_id <input id="vote_cand_id" type="number" value="2" /></label>
            </div>
            <div class="row">
              <button class="success" onclick="castVote()">POST /api/votes</button>
              <button onclick="castVoteAuto()">Cast (auto-setup)</button>
            </div>
          </div>

          <div class="card">
            <h2>Q9 — Candidate Votes</h2>
            <div class="row"><label>candidate_id <input id="cand_votes_id" type="number" value="2" /></label></div>
            <div class="row"><button onclick="candidateVotes()">GET /api/candidates/{id}/votes</button></div>
          </div>

          <div class="card">
            <h2>Q10 — Filter Candidates</h2>
            <div class="row"><label>party <input id="filter_party" type="text" value="Red Party" /></label></div>
            <div class="row"><button onclick="filterCandidates()">GET /api/candidates?party=</button></div>
          </div>

          <div class="card">
            <h2>Q11 — Results</h2>
            <div class="row"><button onclick="results()">GET /api/results</button></div>
          </div>

          <div class="card">
            <h2>Q12 — Winner</h2>
            <div class="row"><button onclick="winner()">GET /api/results/winner</button></div>
          </div>

          <div class="card">
            <h2>Q13 — Vote Timeline</h2>
            <div class="row"><label>candidate_id <input id="timeline_cand_id" type="number" value="2" /></label></div>
            <div class="row"><button onclick="timeline()">GET /api/votes/timeline</button></div>
          </div>

          <div class="card">
            <h2>Q14 — Conditional Vote Weight</h2>
            <div class="row">
              <label>voter_id <input id="w_voter_id" type="number" value="1" /></label>
              <label>candidate_id <input id="w_cand_id" type="number" value="2" /></label>
            </div>
            <div class="row"><button class="warn" onclick="weighted()">POST /api/votes/weighted</button></div>
          </div>

          <div class="card">
            <h2>Q15 — Range Vote Queries</h2>
            <div class="row">
              <label>candidate_id <input id="range_cand_id" type="number" value="2" /></label>
              <label>from <input id="range_from" type="text" value="2025-09-10T10:00:00Z" /></label>
              <label>to <input id="range_to" type="text" value="2025-09-10T12:00:00Z" /></label>
            </div>
            <div class="row"><button onclick="rangeVotes()">GET /api/votes/range</button></div>
          </div>

          <div class="card">
            <h2>Q16 — Encrypted Ballot</h2>
            <div class="row">
              <label>election_id <input id="enc_election" type="text" value="nat-2025" /></label>
              <label>ciphertext <input id="enc_ciphertext" type="text" value="c" /></label>
              <label>zk_proof <input id="enc_proof" type="text" value="p" /></label>
              <label>voter_pubkey <input id="enc_pubkey" type="text" value="k" /></label>
              <label>nullifier <input id="enc_nullifier" type="text" value="n" /></label>
              <label>signature <input id="enc_sig" type="text" value="s" /></label>
            </div>
            <div class="row"><button class="primary" onclick="encryptedBallot()">POST /api/ballots/encrypted</button></div>
          </div>

          <div class="card">
            <h2>Q17 — Homomorphic Tally</h2>
            <div class="row"><button class="primary" onclick="homomorphic()">POST /api/results/homomorphic</button></div>
          </div>

          <div class="card">
            <h2>Q18 — Differential Privacy</h2>
            <div class="row"><button class="primary" onclick="dp()">POST /api/analytics/dp</button></div>
          </div>

          <div class="card">
            <h2>Q19 — Ranked Choice</h2>
            <div class="row"><button class="primary" onclick="ranked()">POST /api/ballots/ranked</button></div>
          </div>

          <div class="card">
            <h2>Q20 — Risk-Limiting Audit</h2>
            <div class="row"><button class="primary" onclick="rla()">POST /api/audits/rla</button></div>
          </div>
        </div>
        <div class="help">Tip: Run Q6 (candidate), Q1 (voter), then Q8 (vote) to populate results.</div>
      </div>

      <div class="panel">
        <div class="title" style="font-size:16px; margin-bottom:8px;">Response</div>
        <pre id="out" class="out"></pre>
      </div>
    </div>
  </div>
</body>
</html>

